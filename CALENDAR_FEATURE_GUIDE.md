# 日历功能使用指南

## 功能概述

TripTeller 现在支持日期感知的旅行规划功能，用户可以选择旅行开始日期，系统会根据天气、节日和特殊事件来优化行程建议。

## 新增功能特性

### 📅 日期选择器
- **直观的日历界面**：点击日历图标选择旅行日期
- **智能日期限制**：只能选择今天及以后的日期
- **中文界面**：完全中文化的日期显示
- **移动端优化**：响应式设计，支持触摸操作

### 🌤️ 天气集成
- **实时天气数据**：使用 OpenWeather API 获取准确天气信息
- **温度显示**：显示当前温度和体感温度
- **天气图标**：直观的天气状态图标
- **详细信息**：湿度、风速、天气描述

### 🎉 节日和事件
- **国际节日**：新年、情人节、劳动节等
- **中国节日**：春节、清明节、国庆节等
- **城市特色活动**：东京樱花节、巴黎巴士底日、纽约时代广场倒计时等
- **影响评估**：高、中、低影响级别标识

## 使用方法

### 1. 选择旅行日期

1. **点击日历图标**：在城市输入框旁边找到日历图标
2. **选择日期**：在弹出日历中选择您的旅行开始日期
3. **确认选择**：点击日期后自动确认
4. **清除日期**：点击清除按钮可以取消日期选择

### 2. 查看天气和事件信息

选择日期后，系统会自动显示：
- **天气信息**：当前天气状况和温度
- **特殊事件**：该日期的节日和活动
- **影响评估**：事件对旅行的影响程度

### 3. 智能行程规划

系统会根据日期信息优化行程：
- **天气考虑**：雨天推荐室内活动，晴天推荐户外活动
- **节日影响**：避开拥挤的节日区域，或推荐节日特色活动
- **季节性建议**：根据季节调整景点推荐

## 技术实现

### 前端组件

#### DatePicker.vue
```vue
<DatePicker 
  v-model="selectedDate"
  @date-selected="handleDateSelected"
  :min-date="minDate"
/>
```

**主要功能：**
- 日历界面显示
- 日期选择逻辑
- 中文日期格式化
- 移动端适配

#### WeatherInfo.vue
```vue
<WeatherInfo 
  :weather="weatherInfo"
  :events="eventsInfo"
/>
```

**主要功能：**
- 天气信息展示
- 事件列表显示
- 影响级别标识
- 响应式设计

### 后端API端点

#### 天气API
```
POST /api/weather
Content-Type: application/json

{
  "city": "城市名称",
  "lat": "纬度",
  "lon": "经度",
  "date": "2024-01-01"
}

返回：
{
  "weather": {
    "temperature": 25,
    "feels_like": 27,
    "humidity": 60,
    "description": "晴天",
    "icon": "01d",
    "wind_speed": 3.5
  }
```

#### 事件API
```
POST /api/events
Content-Type: application/json

{
  "city": "城市名称",
  "country": "国家",
  "date": "2024-01-01"
}

返回：
{
  "events": [
    {
      "name": "新年",
      "type": "holiday",
      "description": "国际节日: 新年",
      "impact": "high"
    }
  ]
}
```

## 配置要求

### 环境变量
在 `.env` 文件中添加：
```env
# OpenWeather API Key
OPENWEATHER_API_KEY=your_openweather_api_key_here
```

### API密钥获取
1. **OpenWeather API**：
   - 访问 [openweathermap.org](https://openweathermap.org/api)
   - 注册免费账户
   - 获取API密钥
   - 免费版本支持每分钟60次请求

## 支持的节日和事件

### 国际节日
- 新年 (1月1日)
- 情人节 (2月14日)
- 国际妇女节 (3月8日)
- 愚人节 (4月1日)
- 劳动节 (5月1日)
- 国际儿童节 (6月1日)
- 万圣节 (10月31日)
- 圣诞节 (12月25日)
- 新年前夜 (12月31日)

### 中国节日
- 元旦 (1月1日)
- 春节 (2月10日，近似)
- 妇女节 (3月8日)
- 清明节 (4月5日)
- 劳动节 (5月1日)
- 儿童节 (6月1日)
- 教师节 (9月10日)
- 国庆节 (10月1日)

### 城市特色活动
- **东京**：樱花节 (3月20日)、夏季祭典 (7月1日)、新年倒计时 (12月31日)
- **巴黎**：巴士底日 (7月14日)、愚人节 (4月1日)、圣诞节 (12月25日)
- **伦敦**：女王生日 (6月2日)、篝火之夜 (11月5日)、圣诞节 (12月25日)
- **纽约**：独立日 (7月4日)、感恩节 (11月24日)、时代广场倒计时 (12月31日)

## 影响级别

### 高影响 (High Impact)
- 主要节日和庆典
- 可能影响交通和景点开放
- 建议提前预订和规划

### 中等影响 (Medium Impact)
- 地区性节日
- 可能影响特定区域
- 建议了解相关信息

### 低影响 (Low Impact)
- 小型活动
- 对旅行影响较小
- 可作为额外体验

## 智能建议系统

### 天气适配
- **晴天**：推荐户外景点、公园、观景台
- **雨天**：推荐博物馆、室内景点、购物中心
- **雪天**：推荐冬季活动、室内景点
- **高温**：推荐有空调的场所、早晚活动

### 节日适配
- **高影响节日**：避开拥挤区域，选择替代景点
- **特色节日**：推荐节日相关活动和体验
- **交通影响**：考虑节日期间的交通状况

### 季节性建议
- **春季**：推荐赏花、户外活动
- **夏季**：推荐避暑景点、水上活动
- **秋季**：推荐赏叶、户外徒步
- **冬季**：推荐室内景点、冬季活动

## 故障排除

### 常见问题

1. **天气信息不显示**
   - 检查 OpenWeather API 密钥是否正确配置
   - 确认网络连接正常
   - 查看浏览器控制台错误信息

2. **事件信息不准确**
   - 系统使用预定义的事件数据库
   - 某些地方性活动可能未包含
   - 建议结合当地旅游信息

3. **日期选择器不工作**
   - 检查浏览器兼容性
   - 确认 JavaScript 已启用
   - 尝试刷新页面

### 调试模式

在浏览器控制台中查看详细信息：
```javascript
// 查看选中的日期
console.log('Selected date:', selectedDate.value)

// 查看天气信息
console.log('Weather info:', weatherInfo.value)

// 查看事件信息
console.log('Events info:', eventsInfo.value)
```

## 未来改进

- [ ] 支持多日期选择（往返行程）
- [ ] 天气预报扩展（7天预报）
- [ ] 更多城市特色活动
- [ ] 用户自定义事件
- [ ] 天气预警集成
- [ ] 季节性活动推荐

## 性能优化

### 前端优化
- 日历组件懒加载
- 天气图标缓存
- 事件数据本地存储

### 后端优化
- API响应缓存
- 天气数据缓存（1小时）
- 事件数据预加载

---

这个日历功能让您的旅行规划更加智能和个性化，确保您能够根据具体的旅行日期获得最合适的建议！
